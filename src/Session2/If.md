# if文
ゲームでは「〇〇の時〇〇する」という処理が数多く登場します。数当てゲームを例にするとプレイヤーの予想した数字が正解の数字より小さい場合は「もっと大きい数字です↑」と表示したいです。他にも、残り回数が0回になったら「ゲームオーバー」にしたいですね。スプレッドシートのIF関数を使用すれば「〇〇の時〇〇の値にする」ということは可能ですが、内部で様々な処理を施したい場合は難しいです。GASのif文を学び、より複雑な分岐処理を施せるようになりましょう。

## とりあえず使ってみる
`myFunction`で次のコードを実行してみましょう:

```js
function myFunction() {
  // 年齢
  const age = 24;

  // ①
  if (age < 20) {
    Logger.log('20歳未満は立ち入りできません');
  }

  // ②
  if (age >= 18) {
    Logger.log('自動車免許を取得可能です');
  } else {
    Logger.log('自動車免許を取得することができません');
  }

  // ③
  if (age >= 40) {
    Logger.log('おじさんです');
  } else if (age >= 20) {
    Logger.log('お兄さんです');
  } else {
    Logger.log('キッズです');
  }
}
```
年齢を変更して色々試してみてください、どのテキストが出力されるかに注目してみましょう。

### ①の例
20未満の場合のみ実行され、20以上であればスルーされました。
### ②の例
年齢が18以上の場合は上が、18未満の場合は下のテキストが出力されました。
### ③の例
年齢が40以上なら`おじさん`、20以上なら`お兄さん`、20未満は`キッズ`となりました。
<br><br>
ここで注目するべきは年齢が40歳以上の場合の③の箇所、`age >= 20`の条件も満たしていますが`お兄さん`とは呼ばれないようです。次のように変更した場合はどうなるのかも確かめてみてください。

```js
// ③'
if (age >= 40) {
  Logger.log('おじさんです');
} 
if (age >= 20) {
  Logger.log('お兄さんです');
} else {
  Logger.log('キッズです');
}
```

## if文とは
if文は条件が`真(true)`なら指定した`{ }`で囲まれた範囲の処理を実行する文です。スプレッドシートのIF関数は条件が増える度に式が難読化してしまう問題がありましたが、if文ならどこから始まってどこで終わるのか一目でわかりますね。

### 基本パターンの紹介
①if文だけ
```js
if (条件) {
  // 条件が真の場合に実行される処理
}
```
②if-else文
```js
if (条件) {
  // 条件が真の場合の処理
} else {
  // 条件が偽の場合の処理
}
```
③if-else if-else文
```js
if (条件1) {
  // 条件1が真の場合の処理
} else if (条件2) {
  // 条件1が偽かつ条件2が真の場合の処理
} else {
  // どの条件も真でない場合の処理
}
```

真偽などと難しい言い回しをしていますが、要は条件にマッチするかしないかということですね。

## 真偽を表す値(論理型)
条件のところには式が入ります、次のコードを見てみましょう。
```js
if (true) {
  Logger.log('常に実行される');
}

if (false) {
  Logger.log('常に実行されない');
}
```
`true`は真、`false`は偽を表す値です。

## 等価演算子
数学のイコールと代入演算子を混同しないようにという話をしました。ではGASでイコールとノットイコールはどう書くのか見ていきましょう。
```js
function myFunction() {
  const correctNum = 50;
  const guessNum = 50;

  if (correctNum === guessNum) {
    Logger.log('正解です');
  }

  if (correctNum !== guessNum) {
    Logger.log('不正解です');
  }
}
```
`===`はイコール、`!==`はノットイコールを表します。なぜノットイコールが`!`マークかって？`!`は他の演算子と被らないので視覚的に分かりやすいからです。

## 否定演算子
`!`は否定を表します、値の前に`!`を付けるとその値を否定する意味になります。
```js
if (!false) {
  Logger.log(`falseの反対は${!false}です`);
}
```

## 比較演算子
〇〇より大きい、〇〇以上、〇〇未満、〇〇以下を表す演算子は次の通りです:
```js
const value = 40;
// valueが100より大きい
value > 100;
// valueが100以上
value >= 100;
// valueが100未満
value < 100;
// valueが100以下
value <= 100;
```
昔、文字コードの節約のために≧≦は二つの文字を組み合わせて表現していました、今でもその名残が残っていますね。

## 論理演算子
条件が複数個ある場合はどうしましょう、例えば年齢が18歳以上50歳以下の場合、年齢が18歳未満または50歳以上の場合の条件にしたい場合です。スプレッドシートでは`AND`関数や`OR`関数がありましたね、GASでは論理演算子を使用します。
```js
// 年齢が18歳以上50歳以下の場合
if (age >= 18 && age <= 50) {}
// 年齢が18歳未満または年齢が50歳以上の場合
if (age < 18 || age >= 50) {}
```
`&&`は「かつ(AND)」、`||`は「または(OR)」を意味します。関数ではなく演算子であるおかげで、条件式が`AND`地獄にならずに済みます。
```js
// 年齢が2歳、または年齢が4歳以上6歳以下、または年齢が30以上かつ年数が400以上
if (age === 2 || age >= 4 && age <= 6 || age >= 30 && income >= 400) {}
```
また、計算結果に影響を与えませんが敢えて`( )`を付けることで見やすくすることができます。
```js
if (age === 2 || (age >= 4 && age <= 6) || (age >= 30 && income >= 400)) {}
```

条件式を見てすぐ日本語に翻訳できるように、またその逆が行えるようになると処理の流れをスムーズに理解できるようになります。`&&`と`||`、どちらがANDでどちらがORかすぐに答えられますか。

## トピック: 演算子の優先順位
「うわまたでたよ、もう`add(`地獄は嫌だ」  
安心してください、今回は上のように意味ごとに`( )`を付ければ回避できる問題なのでトピック扱いです。今回紹介した演算子も優先順位が設定されています、知らないまま使っていると思わぬバグに悩まされることも・・・
<br><br>
演算子の優先順位が高い順に並べると次のようになります:

1. 単項演算子(`-`や`!`)
2. 算術演算子
3. 等価演算子
4. 比較演算子
5. `&&`(AND演算子)
6. `||`(OR演算子)

次のコードの問題点はどこでしょうか:
```js
const age = 5;
const hasKey = true;
const surname = '田中';
// 年齢が18歳以上か鍵を持っている人で苗字が田中の人
if (age >= 18 || hasKey && surname === '田中') {}
```
<details><summary>答え</summary>
表と照らし合わせるとORよりANDのほうが優先度が高いので、条件式を訳すと「年齢が18歳以上の人または鍵を持っていて苗字が田中の人」となってしまいます。回避するには`( )`を使用すればよいですね。

```js
// 年齢が18歳以上か鍵を持っている人で苗字が田中の人
if ((age >= 18 || hasKey) && surname === '田中') {}
```
</details>
